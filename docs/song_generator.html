<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>song_generator.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>song_generator.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">template_utils</span>   
<span class="kn">import</span> <span class="nn">haikunator</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sample_markov</span>
<span class="kn">from</span> <span class="nn">midiutil.MidiFile</span> <span class="kn">import</span> <span class="n">MIDIFile</span>

<span class="kn">import</span> <span class="nn">generator</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">get_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">par_a</span><span class="p">,</span> <span class="n">par_b</span><span class="p">,</span> <span class="n">par_c</span><span class="p">,</span> <span class="n">val_mul_a</span><span class="p">,</span> <span class="n">val_mul_b</span><span class="p">):</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">par_a</span> <span class="o">*</span> <span class="n">par_b</span><span class="o">/</span> <span class="p">(</span><span class="n">par_b</span> <span class="o">-</span> <span class="n">val</span><span class="o">*</span><span class="n">val_mul_a</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">par_c</span> <span class="o">*</span> <span class="n">par_b</span> <span class="o">/</span> <span class="n">val</span> <span class="o">*</span> <span class="n">val_mul_b</span><span class="p">)]</span>
    <span class="n">bounds</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">bounds</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">organize_blocks</span><span class="p">(</span><span class="n">blocks</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span><span class="p">:</span> 
            <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;play_at&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;play_at&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;number_of_bars&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;number_of_beats_per_bar&#39;</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">blocks</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">shuffle_segments</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">segment_number_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span>
    <span class="n">shuffled_segments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">segment_number_range</span><span class="p">:</span> 
            <span class="n">shuffled_segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">segment</span><span class="p">))</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">shuffled_segments</span><span class="p">)</span>
    <span class="n">organized</span> <span class="o">=</span> <span class="n">organize_blocks</span><span class="p">(</span><span class="n">shuffled_segments</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">organized</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">shuffle_play_at</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">segment_number_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span>
    <span class="n">segments_with_repeats</span> <span class="o">=</span> <span class="p">[[</span><span class="n">segment</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">segment_number_range</span><span class="p">)]</span> <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">]</span>
    <span class="n">prev_segment</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">current_play_at</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">segments_with_repeats</span><span class="p">:</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">segments_with_repeats</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">segment</span> <span class="o">==</span> <span class="n">prev_segment</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments_with_repeats</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">segment</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">segments_with_repeats</span><span class="p">)</span>

        <span class="n">prev_segment</span> <span class="o">=</span> <span class="n">segment</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">segments_with_repeats</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">segments_with_repeats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">segments_with_repeats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">del</span> <span class="n">segments_with_repeats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">segments</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">segment_play_at</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_play_at</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;number_of_bars&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;number_of_beats_per_bar&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;number_repeats&#39;</span><span class="p">])]</span>
        <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;play_at&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">segment_play_at</span>
        <span class="n">current_play_at</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;play_at&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;number_of_bars&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;number_of_beats_per_bar&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">segments</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">create_segment_percussion</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="n">percussion</span> <span class="o">=</span> <span class="n">template_utils</span><span class="o">.</span><span class="n">create_percussion</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">no_hits</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">no_cymbals</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>percussion['blocks'][0]['pattern'] = [1] * (segment['number_of_beats_per_bar']%2) + [4]*int(segment['number_of_beats_per_bar']/4)
   percussion['blocks'][0]['default_accent'] = 80
   print 'Default pattern is : ', percussion['blocks'][0]['pattern']</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">percussion</span><span class="p">[</span><span class="s1">&#39;markov_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">percussion</span><span class="p">[</span><span class="s1">&#39;blocks&#39;</span><span class="p">]:</span> 
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">template_utils</span><span class="o">.</span><span class="n">generate_pattern</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pattern_percussion_min_len_range&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pattern_percussion_max_len_range&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">block</span><span class="p">[</span><span class="s1">&#39;pattern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern</span>
        <span class="n">block</span><span class="p">[</span><span class="s1">&#39;bias_same_note&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;percussion_bias_same_note&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
        <span class="n">block</span><span class="p">[</span><span class="s1">&#39;default_accent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;default_accent&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;percussion_accent_offset&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">percussion</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">create_segment</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">song_instruments</span><span class="p">,</span> <span class="n">song_chord</span><span class="p">,</span> <span class="n">markov_values</span><span class="p">):</span>
    <span class="n">song_root_note</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">template_utils</span><span class="o">.</span><span class="n">base_notes</span><span class="p">)</span>
    <span class="n">segment</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">prev</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">i</span><span class="p">:</span> 
        <span class="n">prev</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bpm_change_prob&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">):</span> 
            <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;bpm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bpm_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">15</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;bpm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev</span><span class="p">[</span><span class="s1">&#39;bpm&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <pre><code>   lower_bpm_bound, higher_bpm_bound = kwargs.get('bpm_bounds', get_bounds(prev['bpm'], -5, 540, 25, 0.99, 0.7))
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <pre><code>   segment['bpm'] = prev['bpm'] + random.randint(lower_bpm_bound, higher_bpm_bound)
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">lower_accent_bound</span><span class="p">,</span> <span class="n">higher_accent_bound</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_accent_bounds&#39;</span><span class="p">,</span> <span class="n">get_bounds</span><span class="p">(</span><span class="n">prev</span><span class="p">[</span><span class="s1">&#39;default_accent&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
        
        <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;default_accent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prev</span><span class="p">[</span><span class="s1">&#39;default_accent&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">lower_accent_bound</span><span class="p">,</span> <span class="n">higher_accent_bound</span><span class="p">),</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_base_default_accent&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;default_accent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_accent_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">85</span><span class="p">)))</span>

    <span class="n">number_segment_instruments_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;no_segment_instruments_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">song_instruments</span><span class="p">)))</span>
    <span class="n">number_segment_instruments</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">number_segment_instruments_range</span><span class="p">)</span>
    
    <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;number_repeats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;number_repeats_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="n">segment_instruments_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;segment_instruments_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
    <span class="n">segment_instruments</span> <span class="o">=</span> <span class="n">song_instruments</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">segment_instruments_range</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_segment_instruments</span><span class="p">)]</span>
    <span class="k">print</span> <span class="s1">&#39;Instruments for &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">],</span> <span class="s1">&#39; are : &#39;</span><span class="p">,</span> <span class="n">segment_instruments</span>

    <span class="n">chords</span> <span class="o">=</span> <span class="n">template_utils</span><span class="o">.</span><span class="n">generate_random_chord_progression</span><span class="p">(</span><span class="n">song_root_note</span><span class="p">,</span> <span class="n">song_chord</span><span class="p">,</span>  <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;chords_per_segment_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">))),</span> <span class="n">scale_choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="s1">&#39;blues&#39;</span><span class="p">],</span> <span class="n">markov_values</span> <span class="o">=</span> <span class="n">markov_values</span><span class="p">,</span> <span class="n">exp_var</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;chord_exp_var&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;number_of_bars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chords</span><span class="p">)</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;number_segment_bars_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
    
    <span class="k">for</span> <span class="n">instrument</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segment_instruments</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>TODO args for low_end and high_end</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">low_end</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">high_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">low_end</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
        
        <span class="n">segment_channel</span> <span class="o">=</span> <span class="n">instrument</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">#+ segment[&#39;track&#39;]*len(segment_instruments) + 1 </span>
        <span class="k">if</span> <span class="n">segment_channel</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="n">segment_channel</span> <span class="o">=</span> <span class="n">instrument</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">segment_instruments</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> 

        <span class="n">pattern</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">instrument_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;low_end&#39;</span> <span class="p">:</span> <span class="n">song_root_note</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">low_end</span><span class="p">),</span> 
            <span class="s1">&#39;high_end&#39;</span> <span class="p">:</span> <span class="n">song_root_note</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">high_end</span><span class="p">),</span> 
            <span class="s1">&#39;channel&#39;</span> <span class="p">:</span> <span class="n">segment_channel</span> <span class="p">,</span> 
            <span class="s1">&#39;program_number&#39;</span> <span class="p">:</span> <span class="n">segment_instruments</span><span class="p">[</span><span class="n">instrument</span><span class="p">],</span> 
            <span class="s1">&#39;default_accent&#39;</span> <span class="p">:</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;default_accent&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;block_default_accent_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))),</span> 
            <span class="s1">&#39;bias_same_note&#39;</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;block_same_note_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">))),</span> 
        <span class="p">}</span>
        <span class="n">max_note_len</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pattern_note_max_len_range&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">min_note_len</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pattern_note_min_len_range&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;segment_instrument_pattern_chance&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span> 
            <span class="n">instrument_kwargs</span><span class="p">[</span><span class="s1">&#39;pattern&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">template_utils</span><span class="o">.</span><span class="n">generate_pattern</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">min_note_len</span><span class="p">,</span> <span class="n">max_note_len</span><span class="p">)</span>
                     
        <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;blocks&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">template_utils</span><span class="o">.</span><span class="n">create_chord_progression</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">chords</span> <span class="o">=</span> <span class="n">chords</span><span class="p">,</span> <span class="n">extra_kwargs</span> <span class="o">=</span> <span class="n">instrument_kwargs</span><span class="p">)</span>


    <span class="n">do_percussion</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">do_percussion</span> <span class="o">&gt;=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;segment_percussion_chance&#39;</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="s1">&#39;blocks&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">segment_instruments</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skip_percussion_treshold&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span> 
        <span class="n">percussion</span> <span class="o">=</span> <span class="n">create_segment_percussion</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>           
        <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;blocks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">percussion</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">segment</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">generate_song</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">song_root_note</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">template_utils</span><span class="o">.</span><span class="n">base_notes</span><span class="p">)</span>
    <span class="n">song_chord</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;song_scale&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="s1">&#39;minor&#39;</span><span class="p">]))</span>
    <span class="n">number_of_segments</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;number_of_segments_range&#39;</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>
    <span class="n">bpm_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bpm_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;markov_values&#39;</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;markov_values&#39;</span><span class="p">])</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> 
            <span class="n">markov_values</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">markov_values</span> <span class="o">=</span> <span class="n">sample_markov</span><span class="o">.</span><span class="n">markov_values</span>

    <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span><span class="n">generate_segment</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;beats_per_bar_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">)),</span> <span class="n">bpm_range</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_segments</span><span class="p">)]</span>

    <span class="n">number_of_instruments_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;number_of_song_instruments_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
    <span class="n">number_of_instruments</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">number_of_instruments_range</span><span class="p">)</span>
    <span class="n">song_instruments</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;instruments_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_instruments</span><span class="p">)]</span>
    <span class="k">print</span> <span class="s1">&#39;Song instruments are : &#39;</span><span class="p">,</span> <span class="n">song_instruments</span>
        
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)):</span>

        <span class="n">create_segment</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">song_instruments</span><span class="p">,</span> <span class="n">song_chord</span><span class="p">,</span> <span class="n">markov_values</span><span class="p">)</span>

    <span class="n">segments</span> <span class="o">=</span> <span class="n">shuffle_play_at</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;segment_shuffle_range&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>   
    <span class="k">print</span> <span class="s1">&#39;Generated segments are : &#39;</span>
    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span> 
        <span class="k">print</span> <span class="s1">&#39;Segment &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">],</span> <span class="s1">&#39; has &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;play_at&#39;</span><span class="p">],</span> <span class="s1">&#39; has  &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;number_of_beats_per_bar&#39;</span><span class="p">],</span> <span class="s1">&#39; beats per bar and &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;number_of_bars&#39;</span><span class="p">],</span> <span class="s1">&#39; bars and lasts &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;number_of_beats_per_bar&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;number_of_bars&#39;</span><span class="p">],</span> <span class="s1">&#39; playing at &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;bpm&#39;</span><span class="p">],</span> <span class="s1">&#39; BPM and I repeat &#39;</span><span class="p">,</span> <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;number_repeats&#39;</span><span class="p">],</span> <span class="s1">&#39; times. &#39;</span>

    <span class="n">base_block</span> <span class="o">=</span> <span class="n">template_utils</span><span class="o">.</span><span class="n">create_base_block</span><span class="p">()</span>

    <span class="n">base_block</span><span class="p">[</span><span class="s1">&#39;blocks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">segments</span>
    <span class="n">base_block</span><span class="p">[</span><span class="s1">&#39;markov_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">markov_values</span>


    <span class="n">gen_name</span> <span class="o">=</span> <span class="n">haikunator</span><span class="o">.</span><span class="n">Haikunator</span><span class="o">.</span><span class="n">haikunate</span><span class="p">()</span>
    <span class="n">song_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;generate_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;generated/&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">gen_name</span> 


    <span class="n">mid</span> <span class="o">=</span> <span class="n">MIDIFile</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
    
    <span class="n">entire_track</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">handle_block</span><span class="p">(</span><span class="n">base_block</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
    <span class="n">mid</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_from_track</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">entire_track</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>mid = generator.generate(base_block)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">soundfont</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;soundfont&#39;</span><span class="p">,</span> <span class="s1">&#39;soundfonts/FluidR3_GM.sf2&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;Using soundfont : &#39;</span><span class="p">,</span> <span class="n">soundfont</span>
    <span class="n">song_path</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">write_mid</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">song_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;get_mid&#39;</span><span class="p">):</span> 
        <span class="k">return</span> <span class="n">song_path</span> <span class="o">+</span> <span class="s1">&#39;.mid&#39;</span>

    <span class="n">generator</span><span class="o">.</span><span class="n">to_wav</span><span class="p">(</span><span class="n">song_path</span><span class="p">,</span> <span class="n">soundfont</span><span class="p">)</span>
    <span class="n">success</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="s1">&#39;lame&#39;</span><span class="p">,</span> <span class="n">song_path</span> <span class="o">+</span> <span class="s1">&#39;.wav&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">song_path</span> <span class="o">+</span> <span class="s1">&#39;.mp3&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">generate_segment</span><span class="p">(</span><span class="n">track_no</span><span class="p">,</span> <span class="n">beats_per_bar_range</span><span class="p">,</span> <span class="n">bpm_range</span><span class="p">):</span>
    <span class="n">segment</span> <span class="o">=</span>  <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;generated_track_no_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">track_no</span><span class="p">),</span>
        <span class="s1">&#39;track&#39;</span> <span class="p">:</span> <span class="n">track_no</span><span class="p">,</span>
        <span class="s1">&#39;play_at&#39;</span> <span class="p">:</span> <span class="p">[],</span> 
        <span class="s1">&#39;number_of_beats_per_bar&#39;</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">beats_per_bar_range</span><span class="p">),</span> 
        <span class="s1">&#39;bpm&#39;</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">bpm_range</span><span class="p">),</span>
        <span class="s1">&#39;block_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;complex&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;blocks&#39;</span> <span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">segment</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> 
        <span class="n">soundfont</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> 
            <span class="n">generate_dir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">soundfont</span> <span class="o">=</span> <span class="s1">&#39;../soundfonts/FluidR3_GM.sf2&#39;</span>
        <span class="n">generate_dir</span> <span class="o">=</span> <span class="s1">&#39;../http_generated/&#39;</span>
    <span class="n">generate_song</span><span class="p">(</span><span class="n">instruments_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">68</span><span class="p">],</span> <span class="n">segment_instruments_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">85</span><span class="p">],</span> <span class="n">soundfont</span> <span class="o">=</span> <span class="n">soundfont</span><span class="p">,</span> <span class="n">generate_dir</span> <span class="o">=</span> <span class="n">generate_dir</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>generate_song(soundfont = soundfont, generate_dir = '../http_generated/')</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>generate_song(soundfont = soundfont, generate_dir = 'http_generated/')</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span> <span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
